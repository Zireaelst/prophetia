// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PROPHETIA - Profit Distribution System
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//
// Week 7: Kar DaÄŸÄ±tÄ±m Sistemi
//
// AMAÃ‡:
// BaÅŸarÄ±lÄ± tahminlerden elde edilen karlarÄ± 3 taraf arasÄ±nda adil ÅŸekilde daÄŸÄ±tmak:
//   - Data Provider (40%): Kaliteli veri saÄŸlayÄ±cÄ±sÄ±nÄ± Ã¶dÃ¼llendir
//   - Model Creator (40%): DoÄŸru model geliÅŸtiricisini Ã¶dÃ¼llendir
//   - Pool Investors (20%): Pasif gelir saÄŸla
//
// EKONOMÄ°K RASYONEL:
// Bu 40-40-20 split, kalite ve katÄ±lÄ±mÄ± teÅŸvik eder:
//   â€¢ YÃ¼ksek pay (40%): Aktif katÄ±lÄ±mcÄ±lar (veri/model) bÃ¼yÃ¼k risk alÄ±r
//   â€¢ Orta pay (20%): Pasif yatÄ±rÄ±mcÄ±lar sermaye saÄŸlar
//   â€¢ Reputasyon sistemi: Ä°yi performans â†’ daha yÃ¼ksek gelecek paylar
//   â€¢ Stake mekanizmasÄ±: KÃ¶tÃ¼ performans â†’ stake kaybÄ±
//
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

program profit_distribution.aleo {
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Ä°mport Edilen Programlar
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    import prophetia_data.aleo;
    import prophetia_models.aleo;
    import prophetia_pool.aleo;
    import betting_system.aleo;
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Records
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    // ProfitShare: Kar paylaÅŸÄ±m receipt'i
    record ProfitShare {
        owner: address,          // AlÄ±cÄ± adresi
        amount: u64,            // AlÄ±nan kar miktarÄ± (scaled)
        role: u8,               // 0=data_provider, 1=model_creator, 2=pool
        prediction_id: u64,     // Hangi tahmin iÃ§in
        reputation_bonus: u64,  // Reputasyon bonusu (scaled, 0-200,000 = 0-20%)
        timestamp: u64          // Ã–deme zamanÄ±
    }
    
    // Stake: Model/Data provider stake'i
    record Stake {
        owner: address,         // Stake sahibi
        amount: u64,           // Stake miktarÄ± (scaled)
        role: u8,              // 0=data_provider, 1=model_creator
        locked_until: u64,     // Unlock timestamp
        slash_count: u64       // KaÃ§ kez slash edildi
    }
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Structs
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    // ParticipantInfo: KatÄ±lÄ±mcÄ± bilgileri
    struct ParticipantInfo {
        address: address,
        reputation_score: u64,  // 0-1,000,000 (0-100%)
        total_contributions: u64, // Toplam katkÄ± sayÄ±sÄ±
        successful_predictions: u64, // BaÅŸarÄ±lÄ± tahmin sayÄ±sÄ±
        stake_amount: u64       // Mevcut stake
    }
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Constants
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    const SCALE: u64 = 1_000_000u64;  // 10^6 scaling
    
    // Kar daÄŸÄ±tÄ±m oranlarÄ± (SCALE'e gÃ¶re)
    const DATA_PROVIDER_SHARE: u64 = 400_000u64;   // 40%
    const MODEL_CREATOR_SHARE: u64 = 400_000u64;   // 40%
    const POOL_SHARE: u64 = 200_000u64;            // 20%
    
    // Reputasyon sistemi
    const MIN_REPUTATION: u64 = 0u64;              // 0%
    const MAX_REPUTATION: u64 = 1_000_000u64;      // 100%
    const INITIAL_REPUTATION: u64 = 500_000u64;    // 50% (yeni kullanÄ±cÄ±lar)
    const MAX_REPUTATION_BONUS: u64 = 200_000u64;  // +20% bonus for 100% rep
    
    // Stake gereksinimleri
    const MIN_STAKE_AMOUNT: u64 = 10_000_000u64;   // 10 tokens minimum
    const STAKE_LOCK_PERIOD: u64 = 86400u64;       // 24 saat (Unix seconds)
    const SLASH_PENALTY: u64 = 100_000u64;         // 10% slash per failure
    const MAX_SLASH_COUNT: u64 = 10u64;            // 10 baÅŸarÄ±sÄ±zlÄ±k â†’ tam kayÄ±p
    
    // Reputasyon deÄŸiÅŸim hÄ±zlarÄ±
    const REPUTATION_GAIN_WIN: u64 = 50_000u64;    // +5% per win
    const REPUTATION_LOSS_FAIL: u64 = 100_000u64;  // -10% per failure
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Mappings
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    // Reputasyon skorlarÄ± (address â†’ reputation)
    mapping reputation_scores: address => u64;
    
    // KatÄ±lÄ±m istatistikleri
    mapping contribution_stats: address => u64;  // total_contributions
    mapping success_stats: address => u64;       // successful_predictions
    
    // Stake bilgileri
    mapping stake_amounts: address => u64;       // current stake
    mapping slash_counts: address => u64;        // slash count
    
    // Kar daÄŸÄ±tÄ±m geÃ§miÅŸi
    mapping distribution_history: u64 => u64;    // prediction_id â†’ total_distributed
    
    // Sistem metrikleri
    mapping system_metrics: u8 => u64;
    // Key 0: total_distributions      // Toplam daÄŸÄ±tÄ±m sayÄ±sÄ±
    // Key 1: total_profit_distributed  // Toplam daÄŸÄ±tÄ±lan kar
    // Key 2: total_data_provider_paid  // Data provider'lara Ã¶denen
    // Key 3: total_model_creator_paid  // Model creator'lara Ã¶denen
    // Key 4: total_pool_allocated      // Pool'a ayrÄ±lan
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // CORE TRANSITION: distribute_profit
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //
    // BaÅŸarÄ±lÄ± bir tahminden elde edilen karÄ± 3 taraf arasÄ±nda daÄŸÄ±tÄ±r.
    //
    // PARAMETERS:
    //   profit_amount: DaÄŸÄ±tÄ±lacak toplam kar (betting kazancÄ±)
    //   data_provider: Veri saÄŸlayÄ±cÄ± adresi
    //   model_creator: Model geliÅŸtirici adresi
    //   prediction_id: Tahmin ID (tracking iÃ§in)
    //
    // RETURNS:
    //   (ProfitShare, ProfitShare): Data provider ve model creator paylarÄ±
    //   (Pool payÄ± otomatik olarak pool.aleo'ya gider)
    //
    // LOGIC:
    //   1. Reputasyon skorlarÄ±nÄ± Ã§ek
    //   2. Base split hesapla (40-40-20)
    //   3. Reputasyon bonusu uygula (max +20%)
    //   4. ProfitShare record'larÄ± oluÅŸtur
    //   5. Pool payÄ±nÄ± pool.aleo'ya gÃ¶nder
    //   6. ReputasyonlarÄ± gÃ¼ncelle (baÅŸarÄ± â†’ +5%)
    //   7. Ä°statistikleri kaydet
    //
    transition distribute_profit(
        public profit_amount: u64,
        public data_provider: address,
        public model_creator: address,
        public prediction_id: u64
    ) -> (ProfitShare, ProfitShare) {
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ADIM 1: REPUTASYON SKORLARINI Ã‡EK
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        // Data provider reputation (varsayÄ±lan: 50% for yeni kullanÄ±cÄ±lar)
        let data_rep: u64 = Mapping::get_or_use(
            reputation_scores,
            data_provider,
            INITIAL_REPUTATION
        );
        
        // Model creator reputation
        let model_rep: u64 = Mapping::get_or_use(
            reputation_scores,
            model_creator,
            INITIAL_REPUTATION
        );
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ADIM 2: BASE SPLIT HESAPLAMA (40-40-20)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        // Base paylar (reputasyon bonusu olmadan)
        let base_data_share: u64 = (profit_amount * DATA_PROVIDER_SHARE) / SCALE;
        let base_model_share: u64 = (profit_amount * MODEL_CREATOR_SHARE) / SCALE;
        let pool_share: u64 = (profit_amount * POOL_SHARE) / SCALE;
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ADIM 3: REPUTASYON BONUSU HESAPLAMA
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        //
        // Formula: bonus = base_share Ã— (reputation / SCALE) Ã— (MAX_BONUS / SCALE)
        //
        // Ã–rnek:
        //   base_share = 40 tokens
        //   reputation = 900_000 (90%)
        //   MAX_BONUS = 200_000 (20%)
        //   bonus = 40 Ã— 0.9 Ã— 0.2 = 7.2 tokens
        //   final_share = 40 + 7.2 = 47.2 tokens
        //
        
        // Data provider bonus
        let data_bonus_multiplier: u64 = (data_rep * MAX_REPUTATION_BONUS) / SCALE;
        let data_bonus: u64 = (base_data_share * data_bonus_multiplier) / SCALE;
        let final_data_share: u64 = base_data_share + data_bonus;
        
        // Model creator bonus
        let model_bonus_multiplier: u64 = (model_rep * MAX_REPUTATION_BONUS) / SCALE;
        let model_bonus: u64 = (base_model_share * model_bonus_multiplier) / SCALE;
        let final_model_share: u64 = base_model_share + model_bonus;
        
        // Bonus'lar pool payÄ±ndan dÃ¼ÅŸÃ¼lÃ¼r (toplam = profit_amount)
        let adjusted_pool_share: u64 = pool_share - data_bonus - model_bonus;
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ADIM 4: ProfitShare RECORD'LARI OLUÅTUR
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        let data_profit_share: ProfitShare = ProfitShare {
            owner: data_provider,
            amount: final_data_share,
            role: 0u8,  // Data provider
            prediction_id: prediction_id,
            reputation_bonus: data_bonus,
            timestamp: block.height
        };
        
        let model_profit_share: ProfitShare = ProfitShare {
            owner: model_creator,
            amount: final_model_share,
            role: 1u8,  // Model creator
            prediction_id: prediction_id,
            reputation_bonus: model_bonus,
            timestamp: block.height
        };
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ADIM 5: POOL PAYINI GÃ–NDER
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        // Pool payÄ±, pool.aleo'ya record_profit() ile eklenir
        // Bu, tÃ¼m LP token sahiplerine otomatik daÄŸÄ±tÄ±r (share value artÄ±ÅŸÄ±)
        prophetia_pool.aleo/record_profit(adjusted_pool_share);
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ADIM 6: REPUTASYONLARI GÃœNCELLE (BAÅARI BONUSU)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        // Data provider reputation artÄ±r (+5%)
        let new_data_rep: u64 = data_rep + REPUTATION_GAIN_WIN;
        let clamped_data_rep: u64 = new_data_rep <= MAX_REPUTATION ? 
            new_data_rep : MAX_REPUTATION;
        
        Mapping::set(reputation_scores, data_provider, clamped_data_rep);
        
        // Model creator reputation artÄ±r (+5%)
        let new_model_rep: u64 = model_rep + REPUTATION_GAIN_WIN;
        let clamped_model_rep: u64 = new_model_rep <= MAX_REPUTATION ? 
            new_model_rep : MAX_REPUTATION;
        
        Mapping::set(reputation_scores, model_creator, clamped_model_rep);
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ADIM 7: Ä°STATÄ°STÄ°KLERÄ° GÃœNCELLE
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        // Contribution counts
        let data_contributions: u64 = Mapping::get_or_use(
            contribution_stats, data_provider, 0u64
        );
        Mapping::set(contribution_stats, data_provider, data_contributions + 1u64);
        
        let model_contributions: u64 = Mapping::get_or_use(
            contribution_stats, model_creator, 0u64
        );
        Mapping::set(contribution_stats, model_creator, model_contributions + 1u64);
        
        // Success counts
        let data_successes: u64 = Mapping::get_or_use(
            success_stats, data_provider, 0u64
        );
        Mapping::set(success_stats, data_provider, data_successes + 1u64);
        
        let model_successes: u64 = Mapping::get_or_use(
            success_stats, model_creator, 0u64
        );
        Mapping::set(success_stats, model_creator, model_successes + 1u64);
        
        // Distribution history
        Mapping::set(distribution_history, prediction_id, profit_amount);
        
        // System metrics
        let total_dists: u64 = Mapping::get_or_use(system_metrics, 0u8, 0u64);
        Mapping::set(system_metrics, 0u8, total_dists + 1u64);
        
        let total_profit: u64 = Mapping::get_or_use(system_metrics, 1u8, 0u64);
        Mapping::set(system_metrics, 1u8, total_profit + profit_amount);
        
        let total_data_paid: u64 = Mapping::get_or_use(system_metrics, 2u8, 0u64);
        Mapping::set(system_metrics, 2u8, total_data_paid + final_data_share);
        
        let total_model_paid: u64 = Mapping::get_or_use(system_metrics, 3u8, 0u64);
        Mapping::set(system_metrics, 3u8, total_model_paid + final_model_share);
        
        let total_pool_alloc: u64 = Mapping::get_or_use(system_metrics, 4u8, 0u64);
        Mapping::set(system_metrics, 4u8, total_pool_alloc + adjusted_pool_share);
        
        return (data_profit_share, model_profit_share);
    }
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // TRANSITION: penalize_failure
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //
    // BaÅŸarÄ±sÄ±z tahmin durumunda reputasyon cezasÄ± uygular.
    //
    // PARAMETERS:
    //   data_provider: Veri saÄŸlayÄ±cÄ± adresi
    //   model_creator: Model geliÅŸtirici adresi
    //   loss_amount: Kaybedilen miktar (stake iÃ§in)
    //
    // RETURNS:
    //   None (sadece state gÃ¼nceller)
    //
    // LOGIC:
    //   1. Reputasyon dÃ¼ÅŸÃ¼r (-10%)
    //   2. BaÅŸarÄ±sÄ±zlÄ±k sayaÃ§larÄ±nÄ± artÄ±r
    //   3. EÄŸer stake varsa slash et (%10)
    //   4. Max slash count'a ulaÅŸÄ±lmÄ±ÅŸsa stake'i tamamen al
    //
    transition penalize_failure(
        public data_provider: address,
        public model_creator: address,
        public loss_amount: u64
    ) {
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ADIM 1: REPUTASYON DÃœÅÃœR (-10%)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        // Data provider penalty
        let data_rep: u64 = Mapping::get_or_use(
            reputation_scores,
            data_provider,
            INITIAL_REPUTATION
        );
        
        let new_data_rep: u64 = data_rep >= REPUTATION_LOSS_FAIL ? 
            data_rep - REPUTATION_LOSS_FAIL : MIN_REPUTATION;
        
        Mapping::set(reputation_scores, data_provider, new_data_rep);
        
        // Model creator penalty
        let model_rep: u64 = Mapping::get_or_use(
            reputation_scores,
            model_creator,
            INITIAL_REPUTATION
        );
        
        let new_model_rep: u64 = model_rep >= REPUTATION_LOSS_FAIL ? 
            model_rep - REPUTATION_LOSS_FAIL : MIN_REPUTATION;
        
        Mapping::set(reputation_scores, model_creator, new_model_rep);
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ADIM 2: CONTRIBUTION SAYAÃ‡LARINI ARTIR (baÅŸarÄ±sÄ±zlÄ±k da contribution)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        let data_contributions: u64 = Mapping::get_or_use(
            contribution_stats, data_provider, 0u64
        );
        Mapping::set(contribution_stats, data_provider, data_contributions + 1u64);
        
        let model_contributions: u64 = Mapping::get_or_use(
            contribution_stats, model_creator, 0u64
        );
        Mapping::set(contribution_stats, model_creator, model_contributions + 1u64);
        
        // (success_stats deÄŸiÅŸmez - sadece kazanÃ§larda artÄ±rÄ±lÄ±r)
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ADIM 3: STAKE SLASH (EÄŸer stake varsa %10 ceza)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        // Data provider stake slash
        let data_stake: u64 = Mapping::get_or_use(stake_amounts, data_provider, 0u64);
        if data_stake > 0u64 {
            let slash: u64 = (data_stake * SLASH_PENALTY) / SCALE;
            let new_stake: u64 = data_stake - slash;
            Mapping::set(stake_amounts, data_provider, new_stake);
            
            // Slash count artÄ±r
            let data_slashes: u64 = Mapping::get_or_use(slash_counts, data_provider, 0u64);
            Mapping::set(slash_counts, data_provider, data_slashes + 1u64);
            
            // Max slash â†’ stake tamamen gider
            if data_slashes + 1u64 >= MAX_SLASH_COUNT {
                Mapping::set(stake_amounts, data_provider, 0u64);
            }
        }
        
        // Model creator stake slash
        let model_stake: u64 = Mapping::get_or_use(stake_amounts, model_creator, 0u64);
        if model_stake > 0u64 {
            let slash: u64 = (model_stake * SLASH_PENALTY) / SCALE;
            let new_stake: u64 = model_stake - slash;
            Mapping::set(stake_amounts, model_creator, new_stake);
            
            let model_slashes: u64 = Mapping::get_or_use(slash_counts, model_creator, 0u64);
            Mapping::set(slash_counts, model_creator, model_slashes + 1u64);
            
            if model_slashes + 1u64 >= MAX_SLASH_COUNT {
                Mapping::set(stake_amounts, model_creator, 0u64);
            }
        }
        
        return;
    }
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // TRANSITION: deposit_stake
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //
    // KullanÄ±cÄ±lar stake deposit eder (gÃ¼ven teminatÄ±).
    //
    // PARAMETERS:
    //   amount: Stake miktarÄ± (min 10 tokens)
    //   role: 0=data_provider, 1=model_creator
    //
    // RETURNS:
    //   Stake record (private ownership)
    //
    transition deposit_stake(
        public amount: u64,
        public role: u8
    ) -> Stake {
        
        // Validasyon: Minimum stake
        assert(amount >= MIN_STAKE_AMOUNT);
        
        // Validasyon: Valid role
        assert(role == 0u8 || role == 1u8);
        
        // Mevcut stake'i Ã§ek
        let current_stake: u64 = Mapping::get_or_use(
            stake_amounts,
            self.caller,
            0u64
        );
        
        // Yeni toplam stake
        let new_stake: u64 = current_stake + amount;
        Mapping::set(stake_amounts, self.caller, new_stake);
        
        // Lock period (24 saat)
        let unlock_time: u64 = block.height + STAKE_LOCK_PERIOD;
        
        // Slash count sÄ±fÄ±rla (yeni stake ile temiz baÅŸlangÄ±Ã§)
        Mapping::set(slash_counts, self.caller, 0u64);
        
        // Stake record oluÅŸtur
        let stake_record: Stake = Stake {
            owner: self.caller,
            amount: amount,
            role: role,
            locked_until: unlock_time,
            slash_count: 0u64
        };
        
        return stake_record;
    }
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // TRANSITION: withdraw_stake
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //
    // Stake'i geri Ã§eker (lock period sonrasÄ±).
    //
    // PARAMETERS:
    //   stake: Stake record
    //
    // RETURNS:
    //   amount: Geri Ã§ekilen miktar
    //
    transition withdraw_stake(
        stake: Stake
    ) -> u64 {
        
        // Ownership check
        assert(stake.owner == self.caller);
        
        // Lock period check
        assert(block.height >= stake.locked_until);
        
        // Mevcut stake'i Ã§ek
        let current_stake: u64 = Mapping::get_or_use(
            stake_amounts,
            self.caller,
            0u64
        );
        
        // Withdraw amount (slash'ler uygulandÄ±ktan sonra kalan)
        let withdraw_amount: u64 = current_stake;
        
        // Stake'i sÄ±fÄ±rla
        Mapping::set(stake_amounts, self.caller, 0u64);
        
        // Slash count sÄ±fÄ±rla
        Mapping::set(slash_counts, self.caller, 0u64);
        
        return withdraw_amount;
    }
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // TRANSITION: get_participant_info
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //
    // Bir katÄ±lÄ±mcÄ±nÄ±n tÃ¼m bilgilerini dÃ¶ner.
    //
    transition get_participant_info(
        public participant: address
    ) -> ParticipantInfo {
        
        let reputation: u64 = Mapping::get_or_use(
            reputation_scores,
            participant,
            INITIAL_REPUTATION
        );
        
        let contributions: u64 = Mapping::get_or_use(
            contribution_stats,
            participant,
            0u64
        );
        
        let successes: u64 = Mapping::get_or_use(
            success_stats,
            participant,
            0u64
        );
        
        let stake: u64 = Mapping::get_or_use(
            stake_amounts,
            participant,
            0u64
        );
        
        let info: ParticipantInfo = ParticipantInfo {
            address: participant,
            reputation_score: reputation,
            total_contributions: contributions,
            successful_predictions: successes,
            stake_amount: stake
        };
        
        return info;
    }
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // TRANSITION: calculate_success_rate
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //
    // Bir katÄ±lÄ±mcÄ±nÄ±n baÅŸarÄ± oranÄ±nÄ± hesaplar.
    //
    // RETURNS:
    //   success_rate: 0-1,000,000 (0-100%)
    //
    transition calculate_success_rate(
        public participant: address
    ) -> u64 {
        
        let contributions: u64 = Mapping::get_or_use(
            contribution_stats,
            participant,
            0u64
        );
        
        let successes: u64 = Mapping::get_or_use(
            success_stats,
            participant,
            0u64
        );
        
        // Zero contributions â†’ 0% success rate
        if contributions == 0u64 {
            return 0u64;
        }
        
        // Formula: (successes Ã— SCALE) / contributions
        let success_rate: u64 = (successes * SCALE) / contributions;
        
        return success_rate;
    }
    
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // TRANSITION: get_distribution_stats
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //
    // Sistem-wide daÄŸÄ±tÄ±m istatistiklerini dÃ¶ner.
    //
    // RETURNS:
    //   (total_distributions, total_profit, data_paid, model_paid, pool_allocated)
    //
    transition get_distribution_stats() -> (u64, u64, u64, u64, u64) {
        
        let total_dists: u64 = Mapping::get_or_use(system_metrics, 0u8, 0u64);
        let total_profit: u64 = Mapping::get_or_use(system_metrics, 1u8, 0u64);
        let data_paid: u64 = Mapping::get_or_use(system_metrics, 2u8, 0u64);
        let model_paid: u64 = Mapping::get_or_use(system_metrics, 3u8, 0u64);
        let pool_alloc: u64 = Mapping::get_or_use(system_metrics, 4u8, 0u64);
        
        return (total_dists, total_profit, data_paid, model_paid, pool_alloc);
    }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// USAGE EXAMPLES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// EXAMPLE 1: Successful Prediction Flow
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//
// 1. Betting system wins 100 tokens
// 2. distribute_profit() Ã§aÄŸrÄ±lÄ±r
// 3. Kar daÄŸÄ±tÄ±lÄ±r:
//    - Data provider: 40 tokens (base) + 7.2 tokens (90% rep bonus) = 47.2 tokens
//    - Model creator: 40 tokens (base) + 7.2 tokens (90% rep bonus) = 47.2 tokens
//    - Pool investors: 20 tokens - 14.4 tokens (bonus) = 5.6 tokens
// 4. Reputasyonlar artÄ±rÄ±lÄ±r: 90% â†’ 95%
// 5. BaÅŸarÄ± sayaÃ§larÄ± gÃ¼ncellenir
//
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// EXAMPLE 2: Failed Prediction Flow
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//
// 1. Betting system loses 100 tokens
// 2. penalize_failure() Ã§aÄŸrÄ±lÄ±r
// 3. Reputasyonlar dÃ¼ÅŸÃ¼rÃ¼lÃ¼r: 90% â†’ 80% (-10%)
// 4. EÄŸer stake varsa:
//    - Data provider stake: 50 tokens â†’ 45 tokens (-10% slash)
//    - Model creator stake: 30 tokens â†’ 27 tokens (-10% slash)
// 5. Slash count artÄ±rÄ±lÄ±r: 0 â†’ 1
// 6. 10 baÅŸarÄ±sÄ±zlÄ±k sonrasÄ±: Stake tamamen kaybolur
//
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// EXAMPLE 3: Reputation Impact on Earnings
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//
// Scenario: 100 tokens profit
//
// Low Reputation (50%):
//   - Base: 40 tokens
//   - Bonus: 40 Ã— 0.5 Ã— 0.2 = 4 tokens
//   - Total: 44 tokens
//
// High Reputation (90%):
//   - Base: 40 tokens
//   - Bonus: 40 Ã— 0.9 Ã— 0.2 = 7.2 tokens
//   - Total: 47.2 tokens
//
// Difference: 7.3% more earnings for high reputation! ğŸ’°
//
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// EXAMPLE 4: Stake Mechanics
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//
// Alice deposits 50 tokens stake:
//   deposit_stake(50_000_000u64, 0u8)
//   â†’ Stake record created (locked 24 hours)
//
// After 3 failed predictions:
//   Slash 1: 50 â†’ 45 tokens (-10%)
//   Slash 2: 45 â†’ 40.5 tokens (-10%)
//   Slash 3: 40.5 â†’ 36.45 tokens (-10%)
//   Slash count: 3 / 10
//
// After 10 failed predictions:
//   Slash count: 10 / 10 â†’ Stake completely lost! âŒ
//   Alice must deposit new stake to continue
//
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// KEY INSIGHTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//
// 1. **40-40-20 Split Rationale:**
//    - Active participants (data/model) take on most risk â†’ deserve higher share
//    - Passive investors (pool) provide capital â†’ earn stable returns
//    - Aligns incentives: Quality â†’ More profit
//
// 2. **Reputation System:**
//    - Starts at 50% (neutral for new users)
//    - Win: +5% reputation, better bonuses in future
//    - Loss: -10% reputation, reduced bonuses
//    - Max bonus: +20% (at 100% reputation)
//
// 3. **Stake Mechanism:**
//    - Minimum 10 tokens to participate
//    - Slash 10% per failure (skin in the game)
//    - Max 10 failures â†’ Complete stake loss
//    - Forces quality: Bad performers exit naturally
//
// 4. **Economic Balance:**
//    - Good performers earn MORE (reputation bonus)
//    - Bad performers earn LESS (slashing + low reputation)
//    - Pool always gets 20% (stable passive income)
//    - Self-correcting: Quality rises, spam dies
//
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
